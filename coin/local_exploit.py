from pwn import *
import time 


def main():
    r =  remote("pwnable.kr", 9007)
    r.recv()
    log.info("Sleeping 3 seconds")
    time.sleep(3)
    log.info("Starting")
    for i in range(100):
        response = r.recvline().decode("utf-8") 
        #print(response)
        coins_str , tries_str = response.split()
        _ , n_coins = coins_str.split("=")
        _, n_tries = tries_str.split("=")
        n_coins, n_tries = int(n_coins), int(n_tries)
        log.info(f"Starting round {i}")
        #log.info(f"number of coins {n_coins} , number of tries {n_tries}")
        high = n_coins 
        low = 0 
        mid = 0
        weight = 0
        for i in range(n_tries):
                mid = low + (high - low) // 2
                coins = range(low,mid + 1)
                coins_str = " ".join([str(coin) for coin in coins])
                r.sendline(coins_str)
                response = r.recvline().decode("utf-8")
                weight = int(response)
                log.info(f"{coins} weight is {weight}")
                if weight == 10 and i == (n_tries - 1): 
                    #log.info(f"found {mid + 1} , try {i}")
                    r.sendline(f"{mid + 1}")
                    continue 
                elif weight == 9 and i == (n_tries - 1):
                    #log.info(f"found {low}, try {i}")
                    r.sendline(f"{low}")
                    continue 
                if weight % 10 == 0:
                     low = mid + 1
                else:
                    high = mid 
        response = r.recvline().decode("utf-8")
        print(response)
    print(r.recvline().decode("utf-8"))



if __name__ == "__main__":
    main()
